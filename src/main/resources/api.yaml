swagger: '2.0'
info:
  title: RSpace Inventory API
  description: >
    Welcome to the RSpace Inventory API.


    | Api version | Required minimum RSpace version|

    | --- | --- |

    | 1.7.0 | 1.70 |

    | 1.7.1 | 1.71 |


  version: 1.7.1
  termsOfService: >-
    Currently unrestricted, subject to usage limits returned in X-Rate-Limit headers.
  license:
    name: Apache2 License
    url: 'https://www.apache.org/licenses/LICENSE-2.0'
  contact:
    name: RSpace API Support
    email: support@researchspace.com
basePath: /api/inventory/v1
produces:
  - application/json
consumes:
  - application/json
security:
  - ApiKeySecurity: []
  - OAuthJWT: []
securityDefinitions:
  ApiKeySecurity:
    description: Authentication system based on API Key.
    type: apiKey
    in: header
    name: apiKey
  OAuthJWT:
    description: |
      ##### Please note: you must change 'Client credentials location' from \"Authorization header\" to \"Request body\".
    type: oauth2
    flow: password
    tokenUrl: /oauth/token
    scopes:
      all: Grants access to all API
paths:
  /workbenches:
    get:
      summary: Get all Workbenches visible to the current User
      description: >
        Returns the list with info objects about all workbenches that user can read.
      produces:
        - application/json
      tags:
        - Workbench
      responses:
        '200':
          description: A list of ContainerInfo objects.
  '/workbenches/{workbenchId}':
    get:
      summary: Retrieve a specific Workbench by its ID
      description: >
        Gets details of a specific workbench container, including the summary of its content.
      produces:
        - application/json
      tags:
        - Workbench
      parameters:
        - $ref: '#/parameters/workbenchIdParam'
      responses:
        '200':
          description: A Workbench
          schema:
            $ref: '#/definitions/Container'
        '404':
          $ref: '#/responses/NotFound'

  /samples:
    get:
      summary: Get all Samples visible to the current User
      description: >
        Returns a paginated list of summary information about Samples visible to the current user.

        | Request | Explanation |

        | --- | --- |

        /samples?pageSize=10| Gets first 10 samples

        /samples?ownedBy=user1a| Gets page of samples owned by user1a (assuming current user can see them)

      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/ownedByParam'
        - $ref: '#/parameters/deletedItemsParam'
        - $ref: '#/parameters/pageNumberParam'
        - $ref: '#/parameters/pageSizeParam'
        - $ref: '#/parameters/orderByParam'
      responses:
        '200':
          description: A list of SampleInfo objects.
    post:
      summary: Create a new Sample with one or more SubSamples
      description: >-

        Creates a new Sample in RSpace Inventory.

        Content body is a JSON object defining properties of the sample:
         - `name` is the only required property.
         - `fields` array contains values for fields coming from the sample template. The ordering is important as the content is assigned to  subsequent template fields.
         - `extraFields` array contains values for additional fields that can be added independently from template fields. The order of the fields in array is not important, but each field need to specify `type` and `name`.

        Optionally `newSampleSubSamplesCount` field can be set to create multiple subsamples for a sample. If sample.quantity is provided, it will be divided to calculate quantity of each subsample.

        Returned value is an array with one created sample.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{ "name": "Generic sample" }` | Creates a Sample named "Generic sample", based on Basic Sample template, with empty content, and `sampleSource` default of 'LAB_CREATED'.

        `{ "name": "Sample with image", "newBase64Image":
        "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQIAAAESAQMAAAAsV 0mIAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURf///wAAAFXC034AAAAJcEhZcwAADsMAAA7 DAcdvqGQAAABWSURBVGje7dUhDsAgEETR5VYcv8fCgUEg1rXdhOR9/ZKRE5LO2kwbH4snHe8EQRAEQWxR88g+m yAIgiDeCo9MEARBEP+Lmr/1yARBEARxhyj5fSktYgFPS1k85Tqe JQAAAABJRU5ErkJggg==" }` | As previous example, but includes an image of the sample in Base64.

        `{ "name": "My Sample", "tags": "api", "quantity": { "unitId" : "3", "numericValue" : "50" }, "subSamples": [ { "name": "subSample A", "parentContainers": [ { "id": 11 } ] },
                          { "name": "subSample B", "parentContainers": [ { "id": 11 } ] } ] }`
        | Creates a sample named "My Sample", with 50ml quantity and a 'api' tag, with two subsamples placed inside a container with id = 11.

        `{ "name": "My Sample", "tags": "api", "quantity": { "unitId" : "3", "numericValue" : "50" }, "subSamples": [ { "name": "subSample A", "parentContainers": [ { "id": 11 } ] },
                          { "name": "subSample B", "parentContainers": [ { "id": 11 } ] } ] }`
        | Creates a sample named "My Sample", with 50ml quantity and a 'api' tag, with two subsamples placed inside a container with id = 11.

        `{ "name": "My Sample", "tags": "api", "quantity": { "unitId" : "3", "numericValue" : "50" },"expiryDate":"2021-06-30", "subSamples": [ { "name": "subSample A", "parentLocation": { "id": 21 } } ] }`
        | Creates a sample named "My Sample", with 50ml quantity and a 'api' tag, with an expiration date, with one subsample named "subSample A" placed inside a container location with id = 21.

        `{ "name": "My Refrigerated Sample", "quantity": { "unitId" : "3", "numericValue" : "10" }, "newSampleSubSamplesCount": 2,
          "storageTempMin" : { "numericValue" : 3.00, "unitId" : 8 },
          "storageTempMax" : { "numericValue" : 5.00, "unitId" : 8 }
        }`
        | Creates 10ml sample with a specified storage temperature. The sample will contain two subsamples, 5ml each.

        `{ "name": "My Sample", "sampleSource": "VENDOR_SUPPLIED", "templateId": 1 }` | Creates a new Sample based on template with id = 1, non-default value for 'sampleSource', with default fields and no subsamples.


        `{ "name": "My Complex API Sample #1", "description": "my description", "templateId": 2,
          "fields": [
            { "content": "5.0" },
            { "content": "2020-05-13" },
            { "selectedOptions": ["a"] },
            { "content": "https://researchspace.com" },
            { "selectedOptions": ["b"] },
            { "content": "my string" },
            { "content": "<p>MyText content</p>" },
            { }, { } ],
          "extraFields": [ { "name": "my sample extra field", "type": "text", "content" :"extra sample content (text)" } ],
          "subSamples": [ { "name": "Subsample of My Complex Api Sample",
            "extraFields": [ { "name": "my subsample extra field", "type": "number", "content": "5.15" } ],
            "notes": [ { "content": "my note" } ] } ] }`
         | Creates a complex Sample based on a specific template (with id `2`) which contains 9 fields of various types.

      tags:
        - Samples
      parameters:
        - in: body
          name: sample
          description: 'A sample, with optional fields and subsamples'
          required: true
          schema:
            $ref: '#/definitions/Sample'
      responses:
        '201':
          description: >-
            Success. Returned object represents a created sample.
          schema:
            $ref: '#/definitions/SampleResponse'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'
  '/samples/{sampleId}':
    get:
      summary: Retrieve a complete Sample by ID
      description: |
        Gets a complete Sample, including summary information about subSamples.
      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
      responses:
        '200':
          description: A Sample
          schema:
            $ref: '#/definitions/Sample'
        '404':
          $ref: '#/responses/NotFound'
    put:
      summary: Update a Sample
      description: |
        Updates an existing Sample. The endpoint allows updating properties of the sample and its fields, but not those of its subsamples - these should be updated through the separate `/subSamples` endpoint. Also, this endpoint won't change the owner of the sample - use `/samples/{sampleId}/actions/changeOwner` endpoint for transferring the sample to another user.

        Extra fields belonging to the sample can be updated, added and deleted as a part update action. To create a new extra field, include its definition with additional `newFieldRequest` property set to `true`. To delete an extra field, include a `deleteFieldRequest` property set to `true`.

        The request body should be a JSON object that specifies the details of the update, and must be parsable into `#/definitions/Sample` model.

        This endpoint requires `UPDATE` permission to the Sample.

        ## Examples of the request body

        | Body | Explanation |
        | --- | --- |
        `{}` | Update Sample's last modified date, but doesn't change any of the properties.
        `{ "name": "new name", "tags": "new tags" }` | Updates sample 'name' and 'tags' properties
        `{ "fields": [ { "id": 11, "content": "2020-01-09" } ] }` | Updates sample field (with id 11) with new content
        `{ "extraFields": [ { "id": 21, "content": "...updated" }, { "newFieldRequest": true, "name": "my field", "content": "new field" }, { "id": 22, "deleteFieldRequest": true } ] }` | Updates extra field 21 with new content, deletes extra field 22, and creates new text extra field

      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - $ref: '#/parameters/sampleBodyParam'
      responses:
        '200':
          description: >-
            Success - sample is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

    delete:
      summary: Delete a Sample
      description: |
        Mark sample as deleted, so it won't appear in Inventory UI and default listings. All subsamples belonging to the sample will also be deleted.

        Delete action will stop by default, if subsamples belonging to deleted sample are stored inside container(s). This can be changed by passing "forceDelete" query parameter set to `true`. The default behaviour is so the UI can prompt the user that deleting sample will cause removal of subsamples from their current containers, and ask them for confirmation.

        This action requires `UPDATE` permission to the Sample.

      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - in: query
          name: forceDelete
          description: Proceed with sample deletion even if there are subsamples currently stored inside containers.
          default: false
          type: boolean
      responses:
        '204':
          description: No content

  '/samples/{sampleId}/restore':
    put:
      summary: Restore deleted Sample
      description: |
        Restores deleted sample. The subsamples that were active during sample deletion are also restored,
        and moved to user's Workbench.
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
      responses:
        '200':
          description: >-
            Success - sample is restored.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/samples/{sampleId}/image/{timestamp}':
    get:
      summary: 'Gets a full image connected to the Sample'
      description:
        Returns full image uploaded for the sample.
      produces:
        - image/png
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/samples/{sampleId}/thumbnail/{timestamp}':
    get:
      summary: 'Gets a thumbnail image connected to the Sample'
      description:
        Returns a reduced-size image uploaded for the sample.
      produces:
        - image/png
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/samples/{sampleId}/actions/changeOwner':
    put:
      summary: Transfer the Sample to the new owner
      description: |
        Updates 'owner' field of existing Sample. No other changes to the sample are processed. Use  `/samples/{sampleId}` PUT endpoint to update other fields of the sample.

        This action requires `CHANGE_OWNER` permission to the sample.

        ## Examples of the request body

        | Body | Explanation |
        | --- | --- |
        `{ "owner": { "username": "newOwner" } }` | Changes owner of a sample to newOwner (requires `CHANGE_OWNER` permission). |

      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - $ref: '#/parameters/sampleBodyParam'
      responses:
        '200':
          description: >-
            Success - sample is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/samples/{sampleId}/actions/duplicate':
    post:
      summary: Duplicate a Sample
      description: |

        Generates a deep copy of the sample, including fields, extra fields, images but excluding subsamples. A single subsample will be created with the same quantity as the total quantity of the original sample.

        E.g. original sample S has 10 subsamples of 5ml. After duplication, S-copy will have 1 subsample of 50ml. You can then use `subSample/{id}/actions/duplicate` or  `subSample/{id}/actions/split` to edit the new subsample amounts.

        This action requires `UPDATE` permission to the Sample.
      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
      responses:
        '201':
          description: The new, duplicate sample.
          schema:
            $ref: '#/definitions/Sample'

  '/samples/{sampleId}/actions/updateToLatestTemplateVersion':
    post:
      summary: Update the Sample to match latest definition of its connected Sample Template
      description: |
        If the Sample Template used to create a Sample is updated, the changes only affect future samples created from that template. Calling this endpoint for a given sample will modify it according to changes in the latest template, e.g. will add or rename the field, add new possible radio field option, etc. If template changes cannot be applied to the sample, an error will be returned and sample will not be updated.

        If the template update is non-destructive, e.g. a field was added or renamed, a new radio field option was added etc., the previously created sample can be always updated. Under certain conditions it is also possible to propagate potentially destructive changes to the template, e.g. field deletion or removing radio field option. As a general rule that is possible if the sample doesn't have any content in deleted field.

        If the latest template has new fields that the sample doesn't, these fields are added to the sample, but without setting any default value (even if template field has one). That's to avoid the situation where some samples have field values that user didn't explicitly set nor confirm.

        User must have UPDATE permissions for the sample, and read permissions for the template to run the update action.

        ### Algorithm for for updating sample (S) to latest template version (T)
        - check difference between T and S properties:
          - if T has new subsample alias, update subsample alias of S
        - for each S field check difference between S field and connected T field:
          - if the connected T field was deleted:
            - if the S field value is empty, delete the S field
            - if the S field value is not empty, REJECT WHOLE UPDATE ATTEMPT
          - if the connected T field was renamed, rename the S field
          - if the connected T field was reordered (i.e. moved up or down), reorder the S field
          - if the connected T field is radio/choice, and there is new option set:
            - if the S field value is found within new T option set, update the S field option set
            - if the S field value is not found with new T option set, REJECT WHOLE UPDATE ATTEMPT
        - for each T field, if there is no connected S field (i.e. it's a new field added to T):
          - add the field to S, with empty value (even if T field has a default value, it shouldn't be used)

      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
      responses:
        '200':
          description: The sample updated to latest version of the template.
          schema:
            $ref: '#/definitions/Sample'

  '/samples/{sampleId}/revisions':
    get:
      summary: 'Gets historical revisions of the Sample'
      description:
        Returns list of historical revisions saved for the Sample, starting from the earliest revision.
      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
      responses:
        '200':
          description: A list of revision information objects.

  '/samples/{sampleId}/revisions/{revisionId}':
    get:
      summary: 'Gets historical revision of the Sample'
      description:
        Returns full details of a historical revision saved for the Sample.
      produces:
        - application/json
      tags:
        - Samples
      parameters:
        - $ref: '#/parameters/sampleIdParam'
        - $ref: '#/parameters/revisionIdParam'
      responses:
        '200':
          description: A Sample, as it was at a requested historical revision
          schema:
            $ref: '#/definitions/Sample'
        '404':
          $ref: '#/responses/NotFound'

  '/samples/validateNameForNewSample':
    get:
      summary: Check if given string is valid for naming a new Sample
      tags:
        - Samples
      consumes:
        - text/plain
      parameters:
        - in: query
          name: name
          type: string
          required: true
          description: Name to check.
      responses:
        '200':
          description: JSON object with 'valid' field (true/false) and 'message' field if there is a problem with a name
          schema:
            type: string

  /subSamples:
    get:
      summary: Get all SubSamples visible to the current User
      description: >
        Returns a paginated list of summary information about SubSamples visible to the current user.

         | Request | Explanation |

         | --- | --- |

         /subSamples?pageSize=10| Gets first 10 subSamples

         /subSamples?ownedBy=user1a| Gets page of subSamples owned by user1a (assuming current user can see them)

      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/ownedByParam'
        - $ref: '#/parameters/deletedItemsParam'
        - $ref: '#/parameters/pageNumberParam'
        - $ref: '#/parameters/pageSizeParam'
        - $ref: '#/parameters/orderByParam'
      responses:
        '200':
          description: A list of SubSampleInfo objects.

  '/subSamples/{subSampleId}':
    get:
      summary: Retrieve a SubSample by ID
      description: >
        Retrieve a complete SubSample by ID.
      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '200':
          description: Extra field
          schema:
            $ref: '#/definitions/SubSample'
          examples:
            application/json:
              id: 1867776
              globalId: SS1867776
              _links:
                - link: 'https://myrspace.com/api/inventory/v1/subSample/1867776'
                  rel: self
        '404':
          $ref: '#/responses/NotFound'
    put:
      summary: Update a SubSample with given ID
      description: |
        Updates existing subsample with provided id. The request body should be a JSON object that specifies the details of the update, and must be parsable into `#/definitions/SubSample` model.

        This action requires `UPDATE` permission to the SubSample.

        ## Extra fields

        Extra fields belonging to the subsample can be updated, added and deleted as a partial
        update action. To create a new extra field, include its definition with additional
        `newFieldRequest` property set to `true`. To delete an extra field, include a
        `deleteFieldRequest` property set to `true`.

        ## Notes

        Subsample notes cannot be updated. To add a note to the subsample send POST
        request to the `/subSamples/{subSampleId}/notes` endpoint.

        ## Moving a subsample

        To move a subsample to another container, provide the target container as a first element in `parentContainers` array. For grid/image container you'll also have to provide details of target location in `parentLocation` field: for grid container the provided provided location needs to specify target coordinates, for image container it needs to specify location id.

        When moving multiple items use `/bulk` endpoint with `"operationType": 'MOVE'`.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{ "name": "new Name" }` | Updates a name of the subsample.

        `{ "extraFields": [ { "id": 21, "content": "...updated" }, { "newFieldRequest": true, "name": "my field", "content": "new field" }, { "id": 22, "deleteFieldRequest": true } ] }` | Updates extra field 21 with new content, deletes extra field 22, and creates new text extra field

        `{ "parentContainers": [ { "id": "11"} ] }`
        | Move this subsample into list container 11, without specifying exact location (this will work for list containers)

        `{ "parentContainers": [ { "id": "16"} ],  "parentLocation" : { "coordX": 2, "coordY": 3 } }`
        | Move this subsample into grid container 16, with specifying location coordinates (this will work for grid containers)

        `{ "parentLocation": { "id": "21"} } }`
        | Move this subsample into container location 21 (this will work if location 21 belongs to an image container)

      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/subSampleBodyParam'
      responses:
        '200':
          description: >-
            Success - subsample is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
    delete:
      summary: Delete a SubSample
      description: |
        Mark subsample as deleted, so it won't appear in Inventory UI and default listings. The subsample will also be removed from its current location.

        This action requires `UPDATE` permission to the SubSample.
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '204':
          description: No content

  '/subSamples/{subSampleId}/restore':
    put:
      summary: Restore deleted SubSample
      description: |
        Restores deleted subsample and moves it to  user's Workbench.
        If the parent sample of restored subsample is also deleted, it will be restored, but without restoring any other subsamples.
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '200':
          description: >-
            Success - subsample is restored.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/subSamples/{subSampleId}/notes':
    post:
      summary: Create a new SubSample note.
      description: >-

        The POST request sent to `/subSamples/{subSampleId}/notes` endpoint creates
        a new subsample note.

        The request body should be a JSON object that specifies the details  of
        the note that should be created and must be parsable into
        #/definitions/SubSampleNote model.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{ "content" : "subsample note #1" }` | Creates a new note with some content.

      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/subSampleNoteBodyParam'
      responses:
        '201':
          description: >-
            Success - new note was added. Returned object represents latest subsample.
          schema:
            $ref: '#/definitions/SubSample'
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'

  '/subSamples/{subSampleId}/parentSample':
    get:
      summary: Retrieve a parent Sample
      description: >
        Retrieve a complete parent Sample using ID of a child subsample.

        Returns Sample in the same format as `/samples/{sampleId}` endpoint.
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '200':
          description: A Sample
          schema:
            $ref: '#/definitions/Sample'
        '404':
          $ref: '#/responses/NotFound'

  '/subSamples/{subSampleId}/actions/duplicate':
    post:
      summary: Duplicate a subsample
      description: |
        Generates a deep copy of the subsample.

        This action requires `UPDATE` permission to the SubSample.
      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '201':
          description: The new, duplicate subsample.
          schema:
            $ref: '#/definitions/SubSample'

  '/subSamples/{subSampleId}/actions/split':
    post:
      summary: Splits a subsample
      description: >-

        Generates a deep copy of the subsample, either distributing quantity equally amongst copies, or setting the quantity of each the same as the original, depending on whether `split` is true or false.


        This action requires `UPDATE` permission to the SubSample.

        ## Examples of request body:

        | Body | Explanation |

        | --- | --- |

        `{ "numSubSamples" : "2", "split": "false" }` | Creates 1 duplicate, with the same quantity as the original - this is identical to calling `/actions/duplicate` |

        `{ "numSubSamples" : "10", "split": "true" }` | Creates 9 duplicates, distributing the  original quantity equally. If you had 1 subsample of 100ml, this will result 10 subsamples of 10ml each - the original, plus 9 new duplicates. |

        `{ "numSubSamples" : "10", "split": "false" }` | Creates 9 duplicates, duplicating quantity. If you had 1 subsample of 100ml, this will result in 10 subsamples of 100ml each - the original, plus 9 new duplicates. |
      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/subSampleSplitParam'
      responses:
        '201':
          description: A list of  duplicates subsamples.
          schema:
            $ref: '#/definitions/SubSample'

  '/subSamples/{subSampleId}/image/{timestamp}':
    get:
      summary: 'Gets a full image connected to the SubSample'
      description:
        Returns full image uploaded for the sample.
      produces:
        - image/png
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/subSamples/{subSampleId}/thumbnail/{timestamp}':
    get:
      summary: 'Gets a thumbnail image connected to the SubSample'
      description:
        Returns a reduced-size image uploaded for the subsample.
      produces:
        - image/png
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/subSamples/{subSampleId}/revisions':
    get:
      summary: 'Gets historical revisions of the SubSample'
      description:
        Returns list of historical revisions saved for the SubSample, starting from the earliest revision.
      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
      responses:
        '200':
          description: A list of revision information objects.

  '/subSamples/{subSampleId}/revisions/{revisionId}':
    get:
      summary: 'Gets historical revision of the SubSample'
      description:
        Returns full details of a historical revision saved for the SubSample.
      produces:
        - application/json
      tags:
        - SubSamples
      parameters:
        - $ref: '#/parameters/subSampleIdParam'
        - $ref: '#/parameters/revisionIdParam'
      responses:
        '200':
          description: A SubSample, as it was at a requested historical revision
          schema:
            $ref: '#/definitions/SubSample'
        '404':
          $ref: '#/responses/NotFound'

  /barcodes:
    get:
      summary: 'Gets a barcode for requested content'
      description:
        Get a PNG image representing barcode (or QR code) of the requested content.

      produces:
        - application/json
        - image/png
      tags:
        - Barcodes
      parameters:
        - name: content
          in: query
          type: string
          required: true
          description: content to put into barcode
        - name: barcodeType
          in: query
          type: string
          default: BARCODE
          enum:
            - BARCODE
            - QR
          description: type of requested barcode
        - name: imageWidth
          in: query
          type: integer
          format: int8
          description: requested minimal width of the generated barcode image
        - name: imageHeight
          in: query
          type: integer
          format: int8
          description: requested minimal height of the generated barcode image
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  /sampleTemplates:
    get:
      summary: 'List Sample Templates visible to the current user'
      description: >
        Provides a paginated list of Sample Templates visible to the current user. That includes pre-defined global templates available for every RSpace user.

        This endpoint can be used to retrieve the IDs of the templates from which Samples can be created.

        Sample templates have almost identical data attributes to Samples themselves. Templates can be distinguished by `template=true` property.

        List of returned templates can be limited to templates belonging to the paricular user by passing their username in 'ownedBy' parameter.

      produces:
        - application/json
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/ownedByParam'
        - $ref: '#/parameters/deletedItemsParam'
        - $ref: '#/parameters/pageNumberParam'
        - $ref: '#/parameters/pageSizeParam'
        - $ref: '#/parameters/orderByParam'
      responses:
        '200':
          description: A List of Sample Templates
          schema:
            title: SampleTemplate List Results
            properties:
              totalHits:
                type: number
              pageNumber:
                type: number
              templates:
                $ref: '#/definitions/SampleTemplateList'
              _links:
                $ref: '#/definitions/LinkItemList'
          examples:
            totalHits: 1
            pageNumber: 0
            templates:
              - id: 1
                globalId: IT1
                name: Freshwater Algal sample
                tags: 'algae,grant1234'
                subSampleName: "aliquot"
                defaultUnitId: 3
                template: true
              - id: 2
                globalId: IT2
                name: Marine Algal sample
                tags: 'algae,grant234'
                defaultUnitId: 4
                subSampleName: "subsample"
                template: true
            _links:
              - link: 'https://myrspace.com/api/v1/sampleTemplates'
                rel: self

    post:
      summary: Create a new SampleTemplate
      description: |
        Create a new SampleTemplate, supplying the field definitions.

        ## Mandatory content for SampleTemplates

        Every template must have the following  properties set.

          - name
          - defaultUnitId

        ## Types of  field

        Zero more SampleFields define additional metadata fields for the sample.

      consumes:
        - application/json
        - application/x-yaml
      tags:
        - Sample Templates
      parameters:
        - name: template
          in: body
          description: 'A sampleTemplate definition, with fields'
          required: true
          schema:
            $ref: '#/definitions/SampleTemplatePost'

      responses:
        '201':
          description: Sample Template
          schema:
            $ref: '#/definitions/SampleTemplate'
          examples:
            application/json:
              id: 1867776
              globalId: ST1867776
              name: Antibody Template
              lastModified: '2020-05-18T13:34:01.814Z'
              type: SAMPLE
              subsampleAlias: "ALIQUOT"
              defaultUnitId: 3
              fields:
                - name: A String Field
                  type: String
                  content: Some default value
                - name: A choice field
                  type: choice
                  definition:
                    options: [ '4', '6', '8']
                    multiple: true
                  selectedOptions: [ '4', '8' ]
                - name: A radio field
                  type: radio
                  definition:
                    options: [ '4,', '6', '8']
              _links:
                - link: 'https://myrspace.com/api/inventory/v1/sampleTemplates/1867776'
                  rel: self

  '/sampleTemplates/{sampleTemplateId}':
    get:
      summary: Retrieve an inventory template by ID
      description: >
        Retrieve a sample template  by ID
      produces:
        - application/json
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
      responses:
        '200':
          description: Sample Template Summary
          schema:
            $ref: '#/definitions/SampleTemplateInfo'
          examples:
            application/json:
              id: 1867776
              globalId: ST1867776
              name: Antibody Template
              lastModified: '2020-05-18T13:34:01.814Z'
              type: SAMPLE
              subsampleAlias: "ALIQUOT"
              defaultUnitId: 3

              _links:
                - link: 'https://myrspace.com/api/inventory/v1/sampleTemplates/1867776'
                  rel: self
        '404':
          $ref: '#/responses/NotFound'
    put:
      summary: Update a Sample Template
      description: >
        Updates  properties of an existing  template
        and its fields.

        The request body should be a JSON object that specifies the details  of
        the update, and must be parsable into `#/definitions/Sample` model.

        This action requires `UPDATE` permission to the template.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{}` | Update Sample's last modified date, but doesn't change any of the properties.

        `{ "name": "new name", "tags": "new tags" }` | Updates sample 'name' and 'tags' properties

        `{ "fields": [ { "id": 21, "name": "newName", "content": "...newContent" }, { "newFieldRequest": true, "name": "my field", "type": "string", "content": "new field" }, { "id": 22, "deleteFieldRequest": true } ] }` | Updates field 21 with new name default content, deletes field 22, and adds new string field

      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - $ref: '#/parameters/sampleBodyParam'
      responses:
        '200':
          description: >-
            Success - template is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'
    delete:
      summary: Delete a Sample Template
      description: >
        Mark a sample template as deleted, so it won't appear in Inventory UI and default listings.

        This action requires `UPDATE` permission to the template.

      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
      responses:
        '204':
          description: No content

  '/sampleTemplates/{sampleTemplateId}/restore':
    put:
      summary: Restore deleted Sample Template
      description: |
        Restores deleted sample template.
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
      responses:
        '200':
          description: >-
            Success - sample template is restored.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/sampleTemplates/{sampleTemplateId}/versions/{version}':
    get:
      summary: 'Gets a particular version of a Sample Template'
      description: |
        When retrieving sample template through GET request to `/sampleTemplates/` endpoints you normally see the latest (current) version of the template. Each template has a 'version' property, which starts at 1, and is increased with every update to the template.

        Use this endpoint to retrieve full details of a particular historical version of the template.

        You can check `historicalVersion` boolean flag to distinguish if returned template points to current (latest) version, or historical one. Historical template will also have a `globalId` with version number, and populated `revisionId` field.

      produces:
        - application/json
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - $ref: '#/parameters/versionParam'
      responses:
        '200':
          description: A template, as it was at a requested historical revision
          schema:
            $ref: '#/definitions/Sample'
        '404':
          $ref: '#/responses/NotFound'


  '/sampleTemplates/{sampleTemplateId}/image/{timestamp}':
    get:
      summary: 'Gets a full image connected to the Sample Template'
      description:
        Returns full image uploaded for the template.
      produces:
        - image/png
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/sampleTemplates/{sampleTemplateId}/thumbnail/{timestamp}':
    get:
      summary: 'Gets a thumbnail image connected to the Sample Template'
      description:
        Returns a reduced-size image uploaded for the template.
      produces:
        - image/png
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/sampleTemplates/{sampleTemplateId}/icon':
    post:
      summary: Set or replace a new display icon for a template
      description: >

        Upload a display icon for a template. It should be viewable at 96x96px resolution.

        This action requires `UPDATE` permission to the template.

      produces:
        - application/json
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - name: file
          in: formData
          type: file
          required: true
      consumes:
        - multipart/form-data
      responses:
        '201':
          description: Updated SampleTemplate object with new iconId
          schema:
            $ref: '#/definitions/SampleTemplateInfo'

  '/sampleTemplates/{sampleTemplateId}/icon/{iconId}':
    get:
      summary: 'Gets the icon for the template, if set'
      description:
        Templates can have an icon set for them, to help with visual identification of templates in a list. This methods retrieves the bytes of the image. The IDs can be obtained from an ApiSampleTemplate response  from a `templates/` listing.

        @since 1.7.0
      produces:
        - application/octet-stream
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - name: iconId
          description: The id for the formIcon
          type: integer
          format: int64
          in: path
          required: true
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file


  '/sampleTemplates/{sampleTemplateId}/actions/changeOwner':
    put:
      summary: Transfer the Sample Template to the new owner
      description: |
        Updates 'owner' field of existing Sample Template. No other changes to the sample are processed. Use  `/sampleTemplates/{sampleId}` PUT endpoint to update other fields of the template.

        This action requires `CHANGE_OWNER` permission to the template.

        ## Examples of the request body

        | Body | Explanation |
        | --- | --- |
        `{ "owner": { "username": "newOwner" } }` | Changes owner of a template to newOwner (requires `CHANGE_OWNER` permission). |

      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
        - $ref: '#/parameters/sampleBodyParam'
      responses:
        '200':
          description: >-
            Success - sample template is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/sampleTemplates/{sampleTemplateId}/actions/updateSamplesToLatestTemplateVersion':
    post:
      summary: Update user's samples created from the template to match its latest definition
      description: |
        If the Sample Template used to create a Sample is updated, the changes only affect future samples created from that template. Calling this endpoint will modify pre-existing user samples according to changes in the template. e.g. will add or rename the field, add new possible radio field option, etc. If there is a problem with updating a particular sample that sample is skipped, but the process continues for other samples created from the template.

        Calling this endpoint updates all the samples referencing the non-latest version of the template that user has access to. The detailed update algorithm is described in description of `/samples/{sampleId}/actions/updateToLatestTemplateVersion` POST endpoint

        Result contains list of updated samples/found problems.

        This action checks `UPDATE` permission to the samples.

      produces:
        - application/json
      tags:
        - Sample Templates
      parameters:
        - $ref: '#/parameters/sampleTemplateIdParam'
      responses:
        '200':
          description: >-
            Success.

  /containers:
    get:
      summary: Get top-level Containers visible to the current User
      description: >
        Containers endpoint returns a paginated list of summary information about top-level Containers visible to the current user.

        | Request | Explanation |

        | --- | --- |

        /containers?pageSize=10| Gets first 10 containers

        /containers?ownedBy=user1a| Gets page of top-level container owned by user1a (assuming current user can see them)

      produces:
        - application/json
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/ownedByParam'
        - $ref: '#/parameters/deletedItemsParam'
        - $ref: '#/parameters/pageNumberParam'
        - $ref: '#/parameters/pageSizeParam'
        - $ref: '#/parameters/orderByParam'
      responses:
        '200':
          description: A list of ContainerInfo objects.
    post:
      summary: Create a new Container
      description: >-

        The POST request sent to `/containers` endpoint creates a new Container in RSpace Inventory. Apart from the standard meta-data the POST request can define parent container or location, extra fields, and internal locations. The "name" is the only required property; others are optional.


        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{ "name": "My Container", "cType": "LIST" }` | Creates a default top-level Container with given name.

        `{ "name": "My Container", "cType": "LIST", "tags": "api", "extraFields": [{ "name": "myData", "content" : "extra text content" }] }`
        | Creates top-level Container named "My Container", with a tag and extra field.

        `{ "name": "My Subcontainer #1", "cType": "LIST", "parentContainers": [ { "id": 11 } ] }`
        | Creates default Container named "My Subcontainer", placed inside a container with id = 11.

        `{ "name": "My Subcontainer #2", "cType": "LIST", "parentLocation": { "id": 21 } }`
        | Creates container named "My Subcontainer #2", placed inside a container location with id = 11.

        `{ "name": "24-well plate", "cType": "GRID", "gridLayout": { "columnsNumber": 6, "rowsNumber": 4} }`
        | Creates grid container with 6x4 dimensions.

        `{ "name": "4-shelf box (image Container)", "newBase64LocationsImage": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQIAAAESAQMAAAAsV 0mIAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURf///wAAAFXC034AAAAJcEhZcwAADsMAAA7 DAcdvqGQAAABWSURBVGje7dUhDsAgEETR5VYcv8fCgUEg1rXdhOR9/ZKRE5LO2kwbH4snHe8EQRAEQWxR88g+m yAIgiDeCo9MEARBEP+Lmr/1yARBEARxhyj5fSktYgFPS1k85Tqe JQAAAABJRU5ErkJggg==", "cType": "IMAGE", "locations": [ { "coordX" : 10, "coordY": 15}, { "coordX" : 10, "coordY": 25} ]}` | Creates image Container, with a couple of marked locations.

      tags:
        - Containers
      parameters:
        - in: body
          name: container
          description: 'A container, with optional fields and locations'
          required: true
          schema:
            $ref: '#/definitions/Container'
      responses:
        '201':
          description: >-
            Success. Returned object represents created container.
          schema:
            $ref: '#/definitions/Container'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/containers/{containerId}':
    get:
      summary: Retrieve a complete Container, by ID
      description: >
        Gets a complete Container, including the summary of its content
      produces:
        - application/json
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
      responses:
        '200':
          description: A container
          schema:
            $ref: '#/definitions/Container'
        '404':
          $ref: '#/responses/NotFound'
    put:
      summary: Update a Container with given ID
      description: >
        Updates an
        existing container with provided ID.

        The request body should be a JSON object that specifies the details  of
        the update, and must be parsable into `#/definitions/Container` model.

        This action requires `UPDATE` permission to the container.

        ## Extra fields

        Extra fields belonging to the container can be updated, added and deleted as a part
        update action. To create a new extra field pass its definition with additional
        `newFieldRequest` property set to `true`. To delete an extra field pass a
        `deleteFieldRequest` property set to `true`.

        ## Moving a container

        To move a container,  provide the target container as a first element in `parentContainers` array. For grid/image container you'll also have to provide details of target location in `parentLocation` field: for grid container, provided location needs to specify target coordinates; for image container it needs to specify location id.

         To move a container outside of any other container set `removeFromParentContainerRequest` flag to true in request body. As a result the container will be shown on top level in "Containers" listing.

        When moving multiple items use `/bulk` endpoint with `"operationType": 'MOVE'`.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        `{ "name": "new Name" }` | Updates a name of the container.

        `{ "extraFields": [ { "id": 21, "content": "...updated" }, { "newFieldRequest": true, "name": "my field", "content": "new field" }, { "id": 22, "deleteFieldRequest": true } ] }` | Updates extra field 21 with new content, deletes extra field 22, and creates new text extra field

        `{ "locations": [ { "id": 21, "coordX": "5" }, { "newLocationRequest": true, "coordX": "5", "coordY": "6" }, { "id": 22, "deleteLocationRequest": true } ] }` | Updates container locations: location 21 is assigned new coordX, location 22 is deleted, and new location (5, 6) is created

        `{ "gridLayout": { "columnsNumber": 4, "rowsNumber": 4} }`
        | Updates grid container layout with new dimensions.

        `{ "parentContainers": [ { "id": "11"} ] }`
        | Move this container into list container 11, without specifying exact location (this will work for a list container)

        `{ "parentLocation": { "id": "21"} } }`
        | Move this container into container location 21 (this will work if container location 21 belongs to an image container)

        `{ "removeFromParentContainerRequest": true }`
        | Move this container out of its current location, so it is a top-level container.

        `{ "newBase64Image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQIAAAESAQMAAAAsV 0mIAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURf///wAAAFXC034AAAAJcEhZcwAADsMAAA7 DAcdvqGQAAABWSURBVGje7dUhDsAgEETR5VYcv8fCgUEg1rXdhOR9/ZKRE5LO2kwbH4snHe8EQRAEQWxR88g+m yAIgiDeCo9MEARBEP+Lmr/1yARBEARxhyj5fSktYgFPS1k85Tqe JQAAAABJRU5ErkJggg=="  }` | Updates main image of the Container

      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
        - $ref: '#/parameters/containerBodyParam'
      responses:
        '200':
          description: >-
            Success - container is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
    delete:
      summary: Delete a Container
      description: >
        Mark container as deleted, so it won't appear in Inventory UI and default listings. The container will also be removed from it's current location.

        Only empty containers can be deleted - move the content out first.

        This action requires `UPDATE` permission to the container.

      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
      responses:
        '204':
          description: No content

  '/containers/{containerId}/restore':
    put:
      summary: Restore deleted Container
      description: |
        Restores deleted container and moves it to current user's Bench.
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
      responses:
        '200':
          description: >-
            Success - container is restored.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/containers/{containerId}/image/{timestamp}':
    get:
      summary: 'Gets a full image connected to the Container'
      description:
        Returns a full image uploaded for the container.
      produces:
        - image/png
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/containers/{containerId}/thumbnail/{timestamp}':
    get:
      summary: 'Gets a thumbnail image connected to the Container'
      description:
        Returns a reduced-size image uploaded for the container.
      produces:
        - image/png
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/containers/{containerId}/locationsImage/{timestamp}':
    get:
      summary: 'Gets a locations image connected to the Container'
      description:
        Returns an image used as the background for drawing locations.
      produces:
        - application/json
        - image/png
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
        - $ref: '#/parameters/timeStampParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file

  '/containers/{containerId}/actions/changeOwner':
    put:
      summary: Transfer the Container to the new owner
      description: |
        Updates pdates 'owner' field of existing Container. No other changes to the container are processed. Use  `/containers/{containerId}` PUT endpoint to update other fields of the container.

        This action requires `CHANGE_OWNER` permission to the container.

        ## Examples of the request body

        | Body | Explanation |
        | --- | --- |
        `{ "owner": { "username": "newOwner" } }` | Changes owner of a container to newOwner (requires `CHANGE_OWNER` permission). |

      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
        - $ref: '#/parameters/containerBodyParam'
      responses:
        '200':
          description: >-
            Success - container is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
        '500':
          $ref: '#/responses/LicenseProblem'

  '/containers/{containerId}/actions/duplicate':
    post:
      summary: Duplicate a container
      description: |
        Generates a deep copy of the container.

        This action requires `UPDATE` permission to the container.
      produces:
        - application/json
      tags:
        - Containers
      parameters:
        - $ref: '#/parameters/containerIdParam'
      responses:
        '201':
          description: The new, duplicate subsample.
          schema:
            $ref: '#/definitions/Container'

  /search:
    get:
      summary: Search through inventory items
      description: >
        Returns a paginated list of summary information about inventory items (samples, subsamples, containers and templates) matching search query.

         Search can be limited with 'parentGlobalId' parameter, to include only:
          a) children (content) of a particular container or workbench
          b) samples created from a particular template
          c) subsamples of a given sample

        If 'parentGlobalId' is provided the 'query' parameter can be empty (which returns all children).

         Search can be also limited with 'ownedBy' parameter, to include only items belonging to that user.

        | Query | Explanation |

        | --- | --- |

        /search?query=pcr | Gets samples and subsamples containing the word 'pcr'.

        /search?query=mice&resultType=SUBSAMPLE&orderBy=name%20asc | Get subsamples containing the word 'mice', ordered by subsample name ascending.

      produces:
        - application/json
      tags:
        - Search
      parameters:
        - $ref: '#/parameters/queryParam'
        - $ref: '#/parameters/resultTypeParam'
        - $ref: '#/parameters/parentGlobalIdParam'
        - $ref: '#/parameters/ownedByParam'
        - $ref: '#/parameters/deletedItemsParam'
        - $ref: '#/parameters/pageNumberParam'
        - $ref: '#/parameters/pageSizeParam'
        - $ref: '#/parameters/orderByParam'
      responses:
        '200':
          description: A list of InventoryRecordInfo objects.

  /bulk:
    post:
      summary: Request an operation on a set of Inventory items
      description: >-

        The POST request sent to `/bulk` endpoint executes an operation on a set of items.


        Items passed to `/bulk` endpoint can represent samples, subsamples, containers or any mix of the types. Each item has to have `type` parameter provided, one of:
        `SAMPLE`, `SUBSAMPLE`, `CONTAINER` or `SAMPLE_TEMPLATE`.

        ## Supported operations

        Request body has to provide top-level `operationType` field specifying requested action, which can be one of: `CREATE`, `UPDATE`, `DELETE`, `RESTORE`, `DUPLICATE`, `MOVE`, `CHANGE_OWNER`.


        In principle, the operation executed for a set of items will be the same as calling particular create (POST), update (UPDATE), delete (DELETE), or /duplicate (POST) endpoint directly for each item. The exception is MOVE operation, which executes move for all items 'at once' to support more complex move scenarios like swapping the items inside a container.

        ## Handling mid-operation errors

        By default, if an error is encountered during bulk operation, the whole operation is reverted. This can be changed by setting `"rollbackOnError":false` parameter in the request body. With `"rollbackOnError":false` the operation is executed in a separate transaction for each provided item, and if an error is encountered when processing the particular item, that item is skipped, but the operation continues.


        `MOVE` operation cannot be called with `"rollbackOnError":false` i.e. will always revert if error is encountered. That's because implementation details don't allow for commiting partial move result.

        ## Accessing functionality available through query parameters

        Individual  endpoints may support extra query parameters for additional functionality. For bulk operations, these can be reproduced by setting field with the same name as query parameter, in the JSON body.


        For example: /samples DELETE endpoint supports additional "forceDelete" setting with query parameter. For bulk delete operation the same behaviour can be achieved by passing sample item as { "type": "SAMPLE", "id": "<id>", "forceDelete": <true/false> }.

        ## Examples of the request body

        | Body | Explanation |

        | --- | --- |

        { "operationType": "CREATE", "records": [ { "type": "SAMPLE", "name": "mySample",  "newSampleSubSamplesCount": 2 }, { "type": "CONTAINER", "cType": "LIST", "name": "myContainer" } ] } | Create a sample (with two default subsamples) and a list container.

        { "operationType": "UPDATE", "records": [ { "type": "SUBSAMPLE", "id": "851970", "name":"mySample.updated", "tags":"apiEdited" }, { "type": "SUBSAMPLE", "id": "851971", "tags":"apiEdited", "parentContainers": [ { "id": 720896} ] } ] } | Rename and tag first subsample, tag and move another.

        { "operationType": "MOVE", "records": [ { "type": "SUBSAMPLE", "id": "851970", "parentContainers": [ { "id": 720896} ], "parentLocation": { "coordX": 1, "coordY": 1 } }, { "type": "CONTAINER", "id": "851971", "removeFromParentContainerRequest": true } ] } | Move one subsamples into grid container location, move another container to top-level containers.

        { "operationType": "DELETE", "rollbackOnError": false, "records": [ { "type": "SAMPLE", "id": "851970", "forceDelete": true }, { "type": "CONTAINER", "id": "851971" } ] } | Delete a sample and a container, proceed even if sample has problematic subsamples ("forceDelete": true) and if one of the records cannot be deleted ("rollbackOnError": false).

        { "operationType": "RESTORE", "rollbackOnError": false, "records": [ { "type": "SUBSAMPLE", "id": "851970" }, { "type": "CONTAINER", "id": "851971" } ] } | Restores deleted subsample and a container. If restored subsample belongs to a sample that was deleted, that sample is restored too.

        { "operationType": "CHANGE_OWNER", "records": [ { "type": "SAMPLE", "id": "851970", "owner" : { "username": "newOwner"} }, { "type": "CONTAINER", "id": "851971", "owner" : { "username": "newOwner"} } ] } | Transfers a sample and a container to another user.

      tags:
        - Bulk Operations
      parameters:
        - $ref: '#/parameters/bulkOperationBodyParam'
      responses:
        '201':
          description: >-
            Success.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'

  '/import/parseFile':
    post:
      summary: Parse the incoming CSV file for import samples UI
      description: >
        Parses the provided CSV file, verifies basic structure of the data and suggests the template definition that could be used for running an actual import with `/import/importFile` endpoint.


        The response object returned upon successful parsing contains the following fields:
          * `"templateInfo"` - the definition of a suggested template. The template definition can be modified by the client, or can be used immediately to populate `importSettings.templateInfo` parameter required by `/import/importFile` endpoint
          * ` "columnNameForFieldName"` - it could be that column name used in CSV file is not a valid RSpace field name, in which case the suggested `templateInfo` object will adjust the field name to match the rules. Still, the `/import/importFile` endpoint requires original field name passed in `importSettings.fieldMappings` parameter, and this `"columnNameForFieldName"` map allows finding it
          * `"radioOptionsForColumn"` - it could be that particular column in CSV file should be converted to Radio/Choice field, but the parsing algorithm suggested another field type. In such case the client can adjust `"templateInfo"` field definition and populate radio definition using this map
          * `"samplesCount"` - the field reports number of found samples in CSV file

      produces:
        - application/json
      tags:
        - Import
      parameters:
        - name: file
          in: formData
          type: file
          required: true
      consumes:
        - multipart/form-data
      responses:
        '200':
          description: Parse results.

  '/import/importFile':
    post:
      summary: Import samples from CSV file
      description: >-

        Creates a sample template and imports content of CSV file as samples created from that template.


        `importSettings` must be a JSON object that contains:
           * `templateInfo` field (same as used in sample template POST api, or as retrived by `/import/parseFile` endpoint),
           * `fieldMappings` field that is used to map CSV columns to standard sample fields, and for marking CSV columns that should be ignored.
             To map CSV column name to standard sample field set property of `fieldMappings` with a name of CSV column and a value being one of:
             `name`, `description`, `tags`, `source`, `expiry date`.


        The values from columns not mentioned in `fieldMappings` object will be imported into sample fields  defined by the template (in the order of fields in the template).


        Import result object contains `status` field, which for successful import will be set to "COMPLETED". If any error occurs before/during import process, then all partial changes are reverted (i.e. no template nor any samples will be created unless the status is "COMPLETED").


        ## Examples of the `fieldMappings` object

        | fieldMappings | Explanation |

        | --- | --- |

        "fieldMappings" : { "Antibody Name": "name" } | Use CSV column named 'Antibody Name' for the name of the  imported sample

        "fieldMappings" : { "Name": "name", "Alternative name": "description", "Dummy Data": null, "Best Before": "expiry date" } | Use CSV column named 'Name' for a name of imported sample, "Alternative name" as a description of imported sample, and 'Best Before' as an expiry date. Also ignore CSV column named 'Dummy Data'.

      produces:
        - application/json
      tags:
        - Import
      parameters:
        - name: file
          in: formData
          type: file
          required: true
        - name: importSettings
          in: formData
          type: string
          description: JSON settings string for import operation.
          required: true
      consumes:
        - multipart/form-data
      responses:
        '200':
          description: Import results.

  '/editLocks/{globalId}':
    post:
      summary: Lock the inventory item for editing
      description: >
        Creates an edit lock for an item. When an item is locked, only the user having a lock will be able to modify the it. Lock expires automatically after some time (typically 15-30 minutes). It  can be also released by calling DELETE endpoint.

        User who locked the item can call the endpoint again to extend the lock.

        You must have UPDATE permission for the item to lock it.

      produces:
        - application/json
      tags:
        - Edit Locks
      parameters:
        - $ref: '#/parameters/globalIdParam'
      responses:
        '200':
          description: Lock is set.

    delete:
      summary: Release edit lock from the inventory item
      description: >
        Removes edit lock from the item. You must be an owner of the current lock for the operation to succeed.

      produces:
        - application/json
      tags:
        - Edit Locks
      parameters:
        - $ref: '#/parameters/globalIdParam'
      responses:
        '200':
          description: Lock is released.


  '/files':
    post:
      summary: Upload file as an attachment to the inventory item
      description: >

        Uploads a file as an attachment to the inventory item.

        `fileSettings` must be a JSON object with the following properties:
           * `parentGlobalId` property pointing to the inventory item for which this attachment is uploaded.
           * `fileName` (optional) property containing a name for the file. If not present, the name connected with an uploaded stream will be used

        ## Examples of the `fileSettings` object

        | fileSettings | Explanation |

        | --- | --- |

        { "parentGlobalId": "IC8" } | Add file as attachment to container with id=8, use filename as an attachment name

        { "parentGlobalId": "SA10", "fileName": "test.txt" } | Add file as attachment to sample with id=10, set the attachment name to "test.txt"

      produces:
        - application/json
      tags:
        - Attached Files
      parameters:
        - name: file
          in: formData
          type: file
          required: true
        - name: fileSettings
          in: formData
          type: string
          description: json settings string for upload file operation.
          required: true
      consumes:
        - multipart/form-data
      responses:
        '200':
          description: Upload results.

  '/files/{fileId}':
    get:
      summary: Retrieves details of a file attached to the inventory item
      description: Gets a single ApiFile by its id.
      produces:
        - application/json
      tags:
        - Attached Files
      parameters:
        - $ref: '#/parameters/inventoryFileIdParam'
      responses:
        '200':
          description: A File object.
          schema:
            $ref: '#/definitions/File'
        '404':
          description: 'File does not exist, or you can''t access it.'

    delete:
      summary: Delete inventory file
      description: Marks inventory file as deleted, so it won't appear on attachments list.
      produces:
        - application/json
      tags:
        - Attached Files
      parameters:
        - $ref: '#/parameters/inventoryFileIdParam'
      responses:
        '200':
          description: A File object.
          schema:
            $ref: '#/definitions/File'
        '404':
          description: 'File does not exist, or you can''t access it.'

  '/files/{fileId}/file':
    get:
      summary: Gets binary content of a file attached to the inventory item
      description: >
        Downloads file contents. The content type of the response will be the
        `contentType` of the enclosing media item.

        When calling the endpoint with swagger-ui set the 'Response Content
        Type' to `application/octet-stream` to get a working 'Download file'
        link in response body, or switch the type to `application/json`to debug
        any server error messages.
      produces:
        - application/octet-stream
        - application/json
      tags:
        - Attached Files
      parameters:
        - $ref: '#/parameters/inventoryFileIdParam'
      responses:
        '200':
          description: File as bytes.
          schema:
            type: file


  '/listOfMaterials/forDocument/{docId}':
    get:
      summary: 'Get all lists of materials used in ELN document'
      description:
        Returns all  lists of materials connected to given ELN document.
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/docIdParam'
      responses:
        '200':
          description: List of material usages registered for each field of the document

  '/listOfMaterials/forField/{elnFieldId}':
    get:
      summary: 'Get all list of materials used for a field in ELN document'
      description:
        Return list of materials connected to a field in an ELN document.
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/elnFieldIdParam'
      responses:
        '200':
          description: List of material usages registered for a field of the document

  '/listOfMaterials':
    post:
      summary: Register new list of materials for a particular ELN field
      description: >
        Register usage of an ELN materials within ELN document.

        ## Example POST requests

        | Body | Explanation |

        | --- | --- |

        { "name": "List A", "elnFieldId": 123 } | Create new empty list of materials, named "List A", attached to document field with id 123.

      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/listOfMaterialsBodyParam'
      responses:
        '200':
          description: A registered material usage

  '/listOfMaterials/{lomId}':
    get:
      summary: 'Get a specific list of materials'
      description:
        Endpoint returning a single list of materials connected to an ELN document field.
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/lomIdParam'
      responses:
        '200':
          description: List of material usages registered for each field of the document
    put:
      summary: Save a specific list of materials
      description: >

        Update usage of an ELN materials within ELN document.

        If `usedQuantity` is specified, the client can also request simultanous update of connected
        inventory item. This is done by passing `"updateInventoryQuantity": true` param. The
        quantity of the connected item will be reduced by the quantity used in the list of materials.
        If used quantity is larger than current quantity of connected item, then quantity of connected
        item is set to zero (i.e. it is never negative).

        If the list of materials was already saved with `usedQuantity` for given item, and new
        `usedQuantity` is different, the `updateInventoryQuantity` param will adjust quantity of connected
        item by a difference between old and new used quantity. E.g. if previously saved `usedQuantity`
        was 5 units, and new `usedQuantity` is 6 units, and `updateInventoryQuantity` is set, then
        quantity of connected item will be reduced by 1 unit.

        ## Example PUT requests

        | Body | Explanation |

        | --- | --- |

        { "materials": [ ] } | Removes all materials fom the list

        { "materials": [ { "invRec": { "id": 123, "type": "CONTAINER"} } ] } | Sets the list of used materials to one item - container with id 123.

        { "materials": [ { "invRec": { "id": 123, "type": "CONTAINER"} }, { "invRec": { "id": 234, "type": "SUBSAMPLE" }, "usedQuantity": { "unitId": 3, "numericValue": 5 }, "updateInventoryQuantity": true } ] } | Sets the list of used materials to two items - container with id 123, and 5ml of subsample with id 234. Also reduces the current quantity of subsample 234 by 5ml.

      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/lomIdParam'
        - $ref: '#/parameters/listOfMaterialsBodyParam'
      responses:
        '200':
          description: >-
            Success - container is updated.
        '404':
          $ref: '#/responses/NotFound'
        '422':
          $ref: '#/responses/UnprocessableQuery'
    delete:
      summary: Remove a specific list of materials
      description: >
        .
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/lomIdParam'
      responses:
        '200':
          description: The List of Materials is removed.

  '/listOfMaterials/{lomId}/canEdit':
    get:
      summary: 'Can current user edit a specific list of materials'
      description:
        Endpoint calculates if user can edit a list of materials with given id,
        i.e. whether this list of materials belongs to an experiment that user can edit
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/lomIdParam'
      responses:
        '200':
          description: true/false depending if user can edit the list of materials

  '/listOfMaterials/{lomId}/revisions/{revisionId}':
    get:
      summary: 'Gets historical revision of a specific list of materials'
      description:
        Returns historical revision of a specific list of materials.
      produces:
        - application/json
      tags:
        - ELN integration
      parameters:
        - $ref: '#/parameters/lomIdParam'
        - $ref: '#/parameters/revisionIdParam'
      responses:
        '200':
          description: A list of materials, as it was at a requested historical revision
        '404':
          $ref: '#/responses/NotFound'

definitions:
  InventoryRecordInfo:
    description: Basic information common for RSpace Inventory Entities
    properties:
      id:
        type: integer
        format: int64
        description: Unique identifier for the item.
      globalId:
        type: string
        description: A unique identifier amongst all RSpace data types.
      name:
        type: string
        description: The Sample's name.
      description:
        type: string
        description: The Sample's description.
      created:
        type: string
        format: date-time
        description: The creation time of the item.
      createdBy:
        type: string
        description: Username of the item's creator.
      lastModified:
        type: string
        format: date-time
        description: The last modification time of the item.
      modifiedBy:
        type: string
        description: Username of the last person modifiying the item.
      deleted:
        type: boolean
        description: Whether item is deleted or not.
      iconId:
        type: integer
        format: int64
        description: The item's icon identifier.
      quantity:
        $ref: '#/definitions/Quantity'
      tags:
        type: string
        description: The item's tags.
      barcode:
        type: string
        description: The item's barcode.
  SampleInfo:
    description: Basic information about RSpace Inventory Sample.
    allOf:
      - $ref: '#/definitions/InventoryRecordInfo'
      - properties:
          templateId:
            type: number
            description: Identifier of the template used to create this sample. May be unset if this sample was not created from  a Template
          owner:
            $ref: '#/definitions/User'
          subSampleAlias:
            type: string
            description: How the individual SubSample should be called, e.g. aliquot, unit, etc. Defaults to 'subsample'.
          storageTempMin:
            $ref: '#/definitions/Quantity'
          storageTempMax:
            $ref: '#/definitions/Quantity'
          sampleSource:
            type: string
            description: The source of the sample
            enum:
              - LAB_CREATED
              - VENDOR_SUPPLIED
              - OTHER
          expiryDate:
            type: string
            description: Optional date at which a sample expires, in ISO-8601 format
          _links:
            $ref: '#/definitions/LinkItemList'
  Sample:
    description: A Sample with fields and subsamples
    allOf:
      - $ref: '#/definitions/SampleInfo'
      - properties:
          fields:
            $ref: '#/definitions/SampleFieldList'
          extraFields:
            $ref: '#/definitions/ExtraFieldList'
          subSamples:
            $ref: '#/definitions/SubSampleList'
      - example:
          name: My Sample
          tags: test, api
          sampleSource: VENDOR_SUPPLIED
          expiryDate: 2021-06-30
          quantity:
            numericValue: 2.25
            unitId: 3
          subSamples:
            - name: Hydroxychloroquine
            - name: Azithromycin
            - name: Zinc
  SampleResponse:
    description: Created sample
    example:
      id: 2719744
      globalId: SA2719744
      name: My Sample
      description: null
      created: '2020-05-05T22:15:56.231Z'
      lastModified: '2020-05-05T22:15:56.231Z'
      iconId: null
      quantity:
        numericValue: 2.25
        unitId: 1
      tags: 'test, api'
      barcode: null
      templateId: 26832
      template: false
      owner:
        id: 3342336
        username: matthias
        email: matt@local
        firstName: m
        lastName: k
        homeFolderId: 24556
        _links: []
      subSampleAlias: SUBSAMPLE
      storageTempMin: null
      storageTempMax: null
      fields: []
      subSamples:
        - id: 2097152
          globalId: SS2097152
          name: Hydroxychloroquine
          description: null
          created: '2020-05-05T22:15:56.231Z'
          lastModified: '2020-05-05T22:15:56.231Z'
          iconId: null
          quantity: null
          tags: null
          barcode: null
          notes: null
          _links: []
        - id: 2097153
          globalId: SS2097153
          name: Azithromycin
          description: null
          created: '2020-05-05T22:15:56.232Z'
          lastModified: '2020-05-05T22:15:56.232Z'
          iconId: null
          quantity: null
          tags: null
          barcode: null
          notes: null
          _links: []
        - id: 2097154
          globalId: SS2097154
          name: Zinc
          description: null
          created: '2020-05-05T22:15:56.232Z'
          lastModified: '2020-05-05T22:15:56.232Z'
          iconId: null
          quantity: null
          tags: null
          barcode: null
          notes: null
          _links: []
      _links:
        - link: 'http://myrspace.com/api/inventory/v1/samples/2719744'
          rel: self

  SubSampleInfo:
    description: Information about RSpace inventory SubSample
    allOf:
      - $ref: '#/definitions/InventoryRecordInfo'
      - properties:
          notes:
            type: string
            description: The SubSample's notes.
  SubSample:
    description: Full details of RSpace inventory SubSample
    allOf:
      - $ref: '#/definitions/SubSampleInfo'
      - properties:
          extraFields:
            $ref: '#/definitions/ExtraFieldList'
  SubSampleNote:
    description: Full details of RSpace inventory SubSample
    allOf:
      - properties:
          created:
            type: string
            format: date-time
            description: The creation time of the Sample.
          createdBy:
            type: string
            description: creator's username
          content:
            type: string
            description: content of the note
  SubSampleSplit:
    description: Configure duplication behaviour.
    allOf:
      - properties:
          numSubSamples:
            type: integer
            format: int64
            description: The number of subsamples you require, including the original.
          split:
            type: boolean
            description: Whether to split the quantity equally amongst copies, or not.
    example:
      numSubSamples: 2
      split: true

  SubSampleList:
    description: List of the subsample information objects
    type: array
    items:
      $ref: '#/definitions/SubSampleInfo'
  ContainerInfo:
    description: Basic information about RSpace Inventory Container.
    allOf:
      - $ref: '#/definitions/InventoryRecordInfo'
      - properties:
          cType:
            type: string
            description: container type, one of LIST / GRID / IMAGE
          owner:
            $ref: '#/definitions/User'
          _links:
            $ref: '#/definitions/LinkItemList'
  Container:
    description: A Cntainer with extra fields, locations, and content
    allOf:
      - $ref: '#/definitions/ContainerInfo'
      - properties:
          extraFields:
            $ref: '#/definitions/ExtraFieldList'
          locations:
            $ref: '#/definitions/ExtraFieldList'
      - example:
          name: My Sample Container
          cType: LIST
          tags: test, api
          description: container that can hold samples
          canStoreContainers: false
  Quantity:
    description: A quantity of something, described as a decimal value and a unit.
    properties:
      numericValue:
        type: number
        description: decimal number of any precision
      unitId:
        type: integer
        description: id of a quantity unit
  SampleField:
    description: | 
      A field in a sample or subsample.
      
      @since 1.7.1 'files' and 'listOfMaterials' properties are removed, these were related to ELN document fields and were always null for sample fields. 
      @since 1.7.1 'selectedOptions' property is added, which stores selected values of radio/choice field.
      @since 1.7.1 'definition.options' contains an array of possible options rather than concatenated string.
      @since 1.7.1 'definition.defaultOption' property is removed.
    properties:
      id:
        type: integer
        format: int64
        description: Unique identifier for the SampleField
      globalId:
        type: string
        description: A unique identifier amongst all RSpace data types.
      name:
        type: string
        description: The name of the field.
      lastModified:
        type: string
        format: date-time
        description: The last modified time of this SampleField, in ISO-8601 format.
      type:
        type: string
        description: The data type of this field
        enum:
          - string
          - text
          - choice
          - radio
          - date
          - number
          - time
          - attachment
          - reference
          - uri
      content:
        type: string
        description: | 
          The content as a string. For SampleFields of type 'text' this will be HTML. 
          
          @since 1.7.1 in case of radio/choice field selected choices are passed in 'selectedOptions' property, not in 'content'.
      definition:
        type : object
        description: Some field types require a definition - e.g. radio/choice fields must show what are valid choice options
        properties:
          options:
            type: array
            description: The possible values defined for this field
            items:
              type: string
          multiple:
            type: boolean
            description: Whether multiple values are allowed (choice fields only).
      selectedOptions:
        type: array
        description: list of selected values for radio/choice field
        items:
          type: string
            
  SampleFieldList:
    description: List of the fields in a Sample
    type: array
    items:
      $ref: '#/definitions/SampleField'
  ExtraField:
    description: Information about extra field.
    properties:
      id:
        type: integer
        format: int64
        description: Unique identifier for the ExtraField.
      globalId:
        type: string
        description: A unique identifier amongst all RSpace data types.
      type:
        type: string
        description: The type of the field, allowed values are 'text' or 'number'.
      name:
        type: string
        description: The name of the field.
      content:
        type: string
        description: Current content of the field.
      parentGlobalId:
        type: string
        description: A unique identifier amongst all RSpace data types.
    required: [ parentGlobalId ]
    example:
      type: text
      name: My Field
      content: My string field content
      parentGlobalId: SA1342
  ExtraFieldList:
    description: List of the extra fields in a Sample or SubSample
    type: array
    items:
      $ref: '#/definitions/ExtraField'

  SampleTemplatePost:
    description: 'Definition of a new SampleTemplate, including fields'
    properties:
      name:
        type: string
        description: A required display name for the template/
        minLength: 1
      defaultUnitId:
        type: integer
        description: The id of a unit to measure the amount of the sample. (A mass, volume or dimensionless unit from /units )
      subSampleAlias:
        type : string
        description: One of the following aliases for 'subsample'
        enum:
          - ALIQUOT
          - SUBSAMPLE
          - PIECE
          - PORTION
          - UNIT
      tags:
        type: string
        description: Optional comma-separated list of tags for the template.
      fields:
        $ref: '#/definitions/SampleFieldList'
    example:
      name: Restriction enzyme.
      description: A template for commercial restriction enzymes used in our lab
      tags: 'enzyme, molbiol'
      subSampleAlias: aliquot
      defaultUnitId: 3
      sampleSource: VENDOR_SUPPLIED
      fields:
        - name: Recognition sequence length
          type: Radio
          definition:
            options: [ '4', '6', '8', 'other']
        - name: Incubation Temperature (C)
          type: Number
          content: 37
        - name: Cut-type
          type: Radio
          definition:
            options: [ 'Blunt', 'Overhanging' ]
        - name: Recognition Site
          type: String
        - name: Vendor
          type: Radio
          definition:
            options: [ 'Invitrogen', 'NEB', 'Amersham', 'Sigma']
          selectedOptions: ['Amersham']
        - name: Webpage
          type: URI

  SampleTemplateList:
    description: List of the fields in a Sample or SubSample
    type: array
    items:
      $ref: '#/definitions/SampleTemplateInfo'
  SampleTemplateInfo:
    description: Summary information about a Sample Template.
    allOf:
      - $ref: '#/definitions/SampleInfo'
      - properties:
          defaultUnitId:
            type: integer
            description: The id of a unit, from the /units endpoint
          subSampleName:
            type: string
            description: What name should be used for SubSamples belonging to a Sample created from this Template
          iconId:
            type: number
            description: The identifier for the template's icon, if there is one.

  SampleTemplate:
    description: Full information about Inventory SampleTemplate
    allOf:
      - $ref: '#/definitions/SampleTemplateInfo'
      - properties:
          fields:
            type: array
            description: List of SampleFields
  File:
    description: >-
      Metadata for an image, attachment or linked resource object, but without its binary data.
    properties:
      id:
        type: integer
        format: int64
        description: Unique identifier for the Media item.
      globalId:
        type: string
        description: A unique identifier amongst all RSpace data types.
      name:
        type: string
        description: File name of the attachment
      caption:
        type: string
        description: Optional metadata for the file. @since 1.1.0
      contentType:
        type: string
        description: The media type of the attached file.
      created:
        type: string
        format: date-time
        description: >-
          The creation time of the file (the time it was first uploaded to
          RSpace), in ISO-8601 format.
        x-since: 1.0.0
      size:
        type: integer
        format: int64
        description: 'Size, in bytes, of the file.'
      version:
        type: integer
        format: int64
        description: "File version - @since 1.5.3"
      _links:
        $ref: '#/definitions/LinkItemList'

  LinkItemList:
    description: >
      List of metadata links. Usually contains 'self' link, for paginated result
      also 'next', 'prev', 'first' and 'last' links.
    type: array
    minItems: 0
    items:
      $ref: '#/definitions/LinkItem'
  LinkItem:
    description: A metadata link.
    properties:
      link:
        type: string
        description: URL.
      rel:
        type: string
        description: >
          The relation, an IANA registered relation type as listed
          https://www.iana.org/assignments/link-relations/link-relations.xml
    example:
      link: 'https://myrspace.com/api/v1/files/123'
      type: self
  User:
    description: Representation of a User.
    properties:
      id:
        type: integer
        format: int64
        description: Unique identifier for the User.
      username:
        type: string
        description: Unique username for the User.
        minLength: 6
      email:
        type: string
        description: Email address for User.
        pattern: \S+@\S+
      firstName:
        type: string
        description: First name of the User.
      lastName:
        type: string
        description: Last name of the User.
      homeFolderId:
        type: number
        description: The id of the home folder. May be empty if account has not yet been initialised. @since 1.5.4
    example:
      id: 23
      username: fbloggs
      email: bloggs@uni.edu
      firstName: Fred
      lastName: Bloggs
      homeFolderId: 24556
  Error:
    description: Error object
    properties:
      status:
        type: string
        description: Text representation of Http Status Code.
      httpCode:
        type: integer
        description: HttpStatusCode
      internalCode:
        type: integer
        description: Internal error code to report to RSpace API support team.
      message:
        type: string
        description: Human-readable error message
      errors:
        description: Optional information on errors on individual fields.
        type: array
        items:
          type: string
    example:
      httpCode: 422
      internalCode: 42201
      message: Query could not be processed.
parameters:
  timeStampParam:
    name: timestamp
    in: path
    type: string
    required: true
    description: Ignored by RSpace server; can be any string. Applications using caching can use the timestamp to determine if to reload.
  sampleIdParam:
    name: sampleId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the sample.
  sampleBodyParam:
    name: sample
    in: body
    description: 'A Sample object'
    required: true
    schema:
      $ref: '#/definitions/Sample'
  subSampleIdParam:
    name: subSampleId
    in: path
    type: integer
    format: int64
    required: true
    description: An identifier of the subsample.
  subSampleBodyParam:
    name: subSample
    in: body
    description: 'A SubSample object'
    required: true
    schema:
      $ref: '#/definitions/SubSample'
  subSampleNoteBodyParam:
    name: subSampleNote
    in: body
    description: 'A SubSample note'
    required: true
    schema:
      $ref: '#/definitions/SubSampleNote'
  subSampleSplitParam:
    name: subSampleSplit
    in: body
    description: 'Configuration of duplication behaviour for subsamples'
    required: false
    schema:
      $ref: '#/definitions/SubSampleSplit'
  revisionIdParam:
    name: revisionId
    in: path
    type: integer
    format: int64
    required: true
    description: A revision number of the inventory item
  versionParam:
    name: version
    in: path
    type: integer
    format: int64
    required: true
    description: A version number of the inventory item
  extraFieldIdParam:
    name: extraFieldId
    in: path
    type: integer
    format: int64
    required: true
    description: An identifier of the extra field.
  extraFieldBodyParam:
    name: extraField
    in: body
    description: 'An extra field object'
    required: true
    schema:
      $ref: '#/definitions/ExtraField'
  sampleTemplateIdParam:
    name: sampleTemplateId
    in: path
    type: integer
    format: int64
    required: true
    description: An identifier of the sample template.
  workbenchIdParam:
    name: workbenchId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the workbench.
  containerIdParam:
    name: containerId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the container.
  containerBodyParam:
    name: container
    in: body
    description: 'A Container object'
    required: true
    schema:
      $ref: '#/definitions/Container'
  queryParam:
    name: query
    in: query
    description: Global search query for inventory recods. Required, unless 'parentGlobalId' parameter is provided.
    type: string
  resultTypeParam:
    name: resultType
    in: query
    description: Optional subtype of requested inventory items.
    type: string
    enum:
      - SAMPLE
      - SUBSAMPLE
      - CONTAINER
      - TEMPLATE
  deletedItemsParam:
    name: deletedItems
    in: query
    description: Option deciding about inclusion of deleted items in results (default is EXCLUDED i.e. deleted items are not returned).
    type: string
    enum:
      - EXCLUDE
      - INCLUDE
      - DELETED_ONLY
  globalIdParam:
    name: globalId
    in: path
    type: string
    required: true
    description: A global identifier of the Inventory item.
  parentGlobalIdParam:
    name: parentGlobalId
    in: query
    type: string
    description: Must be a global id of a Container (IC), Workbench (BE), Sample (SA), or Sample Template (IT).
      Limits the results to items being stored inside a container (or workbench), to
      subsamples of a given sample, or to samples created from given template.
  docIdParam:
    name: docId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the ELN document.
  elnFieldIdParam:
    name: elnFieldId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the field within ELN document.
  inventoryFileIdParam:
    name: fileId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the inventory file.
  lomIdParam:
    name: lomId
    in: path
    type: integer
    format: int64
    required: true
    description: A unique identifier of the list of materials.
  listOfMaterialsBodyParam:
    name: listOfMaterialsBody
    in: body
    description: Details of inventory item usage within an ELN document
    required: true
    schema:
      example:
        name: list A
        description: Subsample X from container Y, used in step N of the experiment.
        elnFieldId: 1025
        materials:
          - invRec: { id: 123, type: "SUBSAMPLE" }
            usedQuantity: { unitId: 3, numericValue: 5 }
          - invRec: { id: 52, type: "CONTAINER" }
            usedQuantity: null
  pageNumberParam:
    name: pageNumber
    in: query
    description: 'For paginated results, this is the number of the page requested, 0 based.'
    type: integer
    format: int32
    default: 0
    minimum: 0
  pageSizeParam:
    name: pageSize
    in: query
    description: The maximum number of items to retrieve.
    type: integer
    format: int32
    default: 20
    minimum: 1
    maximum: 50
  orderByParam:
    name: orderBy
    in: query
    description: Sort order for inventory items.
    type: string
    enum:
      - name asc
      - name desc
      - type asc
      - type desc
      - globalId asc
      - globalId desc
      - creationDate asc
      - creationDate desc
      - modificationDate asc
      - modificationDate desc
    default: name asc
  ownedByParam:
    name: ownedBy
    in: query
    description: Username of the owner of requested items
    type: string
  bulkOperationBodyParam:
    name: bulkOperationBody
    in: body
    description: Details of bulk operation
    required: true
    schema:
      example:
        operationType: CREATE
        rollbackOnError: true
        records:
          - type: SAMPLE
            name: mySample
          - type: CONTAINER
            cType: LIST
            name: myContainer
responses:
  UnprocessableQuery:
    description: Query could not be processed.
    schema:
      $ref: '#/definitions/Error'
  NotFound:
    description: Resource could not be found - either does not exist, or client is not authorised.
    schema:
      $ref: '#/definitions/Error'
  TooManyRequests:
    description: Too many requests - see the X-Rate-Limit headers for more information.
    schema:
      $ref: '#/definitions/Error'
  LicenseProblem:
    description: License expired or not active.
    schema:
      $ref: '#/definitions/Error'
 